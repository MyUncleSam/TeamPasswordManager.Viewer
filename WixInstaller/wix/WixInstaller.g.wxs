<?xml version="1.0" encoding="utf-8"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="27aebaa4-d803-47c2-b078-e0eb9732cd09" Name="TeamPasswordManager.Viewer" Language="1033" Codepage="Windows-1252" Version="1.4.3.1630" UpgradeCode="27aebaa4-d803-47c2-b078-e0eb87f297aa" Manufacturer="Stefan Ruepp">
    <Package InstallerVersion="200" Compressed="yes" Description="TeamPasswordManager.Viewer" Platform="x86" SummaryCodepage="Windows-1252" InstallPrivileges="elevated" Languages="1033" />
    <Media Id="1" Cabinet="TeamPasswordManager.Viewer.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder" Name="ProgramFilesFolder">
        <Directory Id="INSTALLDIR" Name="TeamPasswordManager.Viewer">

          <Component Id="Component.Gma.System.MouseKeyHook.dll_494669578" Guid="27aebaa4-d803-47c2-b078-e0ebfa0bc369">
            <File Id="Gma.System.MouseKeyHook.dll_494669578" Source="Deploy\Gma.System.MouseKeyHook.dll" />
          </Component>

          <Component Id="Component.Microsoft.Win32.TaskScheduler.dll_4223500575" Guid="27aebaa4-d803-47c2-b078-e0eb996ef3ac">
            <File Id="Microsoft.Win32.TaskScheduler.dll_4223500575" Source="Deploy\Microsoft.Win32.TaskScheduler.dll" />
          </Component>

          <Component Id="Component.Microsoft.Win32.TaskScheduler.xml_3167862827" Guid="27aebaa4-d803-47c2-b078-e0ebd62227f0">
            <File Id="Microsoft.Win32.TaskScheduler.xml_3167862827" Source="Deploy\Microsoft.Win32.TaskScheduler.xml" />
          </Component>

          <Component Id="Component.Newtonsoft.Json.dll_3014583745" Guid="27aebaa4-d803-47c2-b078-e0ebc299dad0">
            <File Id="Newtonsoft.Json.dll_3014583745" Source="Deploy\Newtonsoft.Json.dll" />
          </Component>

          <Component Id="Component.Newtonsoft.Json.xml_3014518205" Guid="27aebaa4-d803-47c2-b078-e0eb9cc39842">
            <File Id="Newtonsoft.Json.xml_3014518205" Source="Deploy\Newtonsoft.Json.xml" />
          </Component>

          <Component Id="Component.ObjectListView.dll_1913798315" Guid="27aebaa4-d803-47c2-b078-e0eb3ed43cba">
            <File Id="ObjectListView.dll_1913798315" Source="Deploy\ObjectListView.dll" />
          </Component>

          <Component Id="Component.ObjectListView.xml_2385395370" Guid="27aebaa4-d803-47c2-b078-e0eb754e2b8b">
            <File Id="ObjectListView.xml_2385395370" Source="Deploy\ObjectListView.xml" />
          </Component>

          <Component Id="Component.Otp.NET.dll_1916311374" Guid="27aebaa4-d803-47c2-b078-e0ebed7ade89">
            <File Id="Otp.NET.dll_1916311374" Source="Deploy\Otp.NET.dll" />
          </Component>

          <Component Id="Component.Release.zip_146686668" Guid="27aebaa4-d803-47c2-b078-e0eb73268322">
            <File Id="Release.zip_146686668" Source="Deploy\Release.zip" />
          </Component>

          <Component Id="Component.RestSharp.dll_3316305323" Guid="27aebaa4-d803-47c2-b078-e0ebe67a39e7">
            <File Id="RestSharp.dll_3316305323" Source="Deploy\RestSharp.dll" />
          </Component>

          <Component Id="Component.RestSharp.xml_3303251991" Guid="27aebaa4-d803-47c2-b078-e0eb0b2bc1a8">
            <File Id="RestSharp.xml_3303251991" Source="Deploy\RestSharp.xml" />
          </Component>

          <Component Id="Component.TeamPassword.Library.dll_3741339720" Guid="27aebaa4-d803-47c2-b078-e0ebc609cd5d">
            <File Id="TeamPassword.Library.dll_3741339720" Source="Deploy\TeamPassword.Library.dll" />
          </Component>

          <Component Id="Component.TeamPassword.Library.dll.config_2079504822" Guid="27aebaa4-d803-47c2-b078-e0eb3c0fa405">
            <File Id="TeamPassword.Library.dll.config_2079504822" Source="Deploy\TeamPassword.Library.dll.config" />
          </Component>

          <Component Id="Component.TeamPassword.Viewer.exe_2663462321" Guid="27aebaa4-d803-47c2-b078-e0eb34e6671c">
            <File Id="TeamPassword.Viewer.exe_2663462321" Source="Deploy\TeamPassword.Viewer.exe" />
          </Component>

          <Component Id="Component.TeamPassword.Viewer.exe.config_1384372329" Guid="27aebaa4-d803-47c2-b078-e0eb9f55eaba">
            <File Id="TeamPassword.Viewer.exe.config_1384372329" Source="Deploy\TeamPassword.Viewer.exe.config" />
          </Component>

          <Component Id="Component.TeamPasswordManager.Viewer__" Guid="27aebaa4-d803-47c2-b078-e0ebc157624f">
            <Shortcut Id="INSTALLDIR.TeamPasswordManager.Viewer__" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]TeamPassword.Viewer.exe" Name="TeamPasswordManager.Viewer.lnk" />

            <CreateFolder />
            <RemoveFolder Id="INSTALLDIR" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="InternetShortcut" Guid="27aebaa4-d803-47c2-b078-e0eb27392e61" KeyPath="yes">
            <InternetShortcut Name="TeamPasswordManager.Viewer Github" Id="InternetShortcut" Target="https://github.com/MyUncleSam/TeamPasswordManager.Viewer" xmlns="http://schemas.microsoft.com/wix/UtilExtension" />

            <CreateFolder />
          </Component>

        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder" Name="ProgramMenuFolder">
        <Directory Id="ProgramMenuFolder.TeamPasswordManager.Viewer" Name="TeamPasswordManager.Viewer">

          <Component Id="Component.TeamPasswordManager.Viewer.1" Guid="27aebaa4-d803-47c2-b078-e0ebc1a9627e">
            <Shortcut Id="ProgramMenuFolder.TeamPasswordManager.Viewer.TeamPasswordManager.Viewer.1" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]TeamPassword.Viewer.exe" Name="TeamPasswordManager.Viewer.lnk" />

            <CreateFolder />
            <RemoveFolder Id="ProgramMenuFolder.TeamPasswordManager.Viewer" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="InternetShortcut.1" Guid="27aebaa4-d803-47c2-b078-e0eb19a2c013">
            <InternetShortcut Name="TeamPasswordManager.Viewer Github" Id="InternetShortcut.1" Target="https://github.com/MyUncleSam/TeamPasswordManager.Viewer" xmlns="http://schemas.microsoft.com/wix/UtilExtension" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

        </Directory>
      </Directory>
    </Directory>

    <UI />

    <CloseApplication Id="TeamPassword.Viewer.exe" Target="TeamPassword.Viewer.exe" Timeout="15" Sequence="1" CloseMessage="no" ElevatedCloseMessage="no" ElevatedEndSessionMessage="no" EndSessionMessage="no" PromptToContinue="no" RebootPrompt="no" xmlns="http://schemas.microsoft.com/wix/UtilExtension" />

    <Upgrade Id="27aebaa4-d803-47c2-b078-e0eb87f297aa">
      <UpgradeVersion Minimum="0.0.0.0" Maximum="1.4.3.1630" IncludeMinimum="yes" IncludeMaximum="no" Property="UPGRADEFOUND" />
      <UpgradeVersion Minimum="1.4.3.1630" IncludeMinimum="no" Property="NEWPRODUCTFOUND" />
    </Upgrade>

    <CustomAction Id="Set_ARPNOMODIFY" Property="ARPNOMODIFY" Value="True" Return="check" Execute="immediate" />
    <CustomAction Id="PreventDowngrading" Error="Newer version already installed" />

    <UIRef Id="WixUI_Minimal" />
    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="ALLUSERS" Value="1" />
    <Property Id="ARPURLINFOABOUT" Value="https://github.com/MyUncleSam/TeamPasswordManager.Viewer" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="InternetShortcut" />
      <ComponentRef Id="InternetShortcut.1" />
      <ComponentRef Id="Component.Gma.System.MouseKeyHook.dll_494669578" />
      <ComponentRef Id="Component.Microsoft.Win32.TaskScheduler.dll_4223500575" />
      <ComponentRef Id="Component.Microsoft.Win32.TaskScheduler.xml_3167862827" />
      <ComponentRef Id="Component.Newtonsoft.Json.dll_3014583745" />
      <ComponentRef Id="Component.Newtonsoft.Json.xml_3014518205" />
      <ComponentRef Id="Component.ObjectListView.dll_1913798315" />
      <ComponentRef Id="Component.ObjectListView.xml_2385395370" />
      <ComponentRef Id="Component.Otp.NET.dll_1916311374" />
      <ComponentRef Id="Component.Release.zip_146686668" />
      <ComponentRef Id="Component.RestSharp.dll_3316305323" />
      <ComponentRef Id="Component.RestSharp.xml_3303251991" />
      <ComponentRef Id="Component.TeamPassword.Library.dll_3741339720" />
      <ComponentRef Id="Component.TeamPassword.Library.dll.config_2079504822" />
      <ComponentRef Id="Component.TeamPassword.Viewer.exe_2663462321" />
      <ComponentRef Id="Component.TeamPassword.Viewer.exe.config_1384372329" />
      <ComponentRef Id="Component.TeamPasswordManager.Viewer__" />
      <ComponentRef Id="Component.TeamPasswordManager.Viewer.1" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="Set_ARPNOMODIFY" After="CostFinalize"> (NOT Installed) </Custom>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>

      <RemoveExistingProducts After="InstallInitialize" />
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
    </InstallUISequence>

  </Product>
</Wix>

